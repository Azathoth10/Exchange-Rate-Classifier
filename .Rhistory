source("randomPortfolios.r")
library(ggplot2)
alfa <- 0.05
nsim_CVaR <- 10000
nperiods <- nrow(df)
rw <- RWgenerators(10, length(TKs))
rw
source("gbm.r")
source("impstocks.r")
TKs <- c("^GSPC", "EEM", "VGK", "SPMO", "IJR", "AIA")
start <- "2017-05-03"
df <- GetStocks(TKs, start)
source("stock.r")
source("AdjustedCVaRProcedure.r")
source("gbm.r")
source("impstocks.r")
TKs <- c("^GSPC", "EEM", "VGK", "SPMO", "IJR", "AIA")
start <- "2016-05-03"
df <- GetStocks(TKs, start)
df
source("stock.r")
source("AdjustedCVaRProcedure.r")
source("gbm.r")
source("impstocks.r")
TKs <- c("^GSPC", "EEM", "VGK", "SPMO", "IJR", "AIA")
start <- "2016-05-03"
df <- GetStocks(TKs, start)
source("stock.r")
source("AdjustedCVaRProcedure.r")
source("AdjCVaRF.r")
source("randomPortfolios.r")
library(ggplot2)
alfa <- 0.05
nsim_CVaR <- 1000
nperiods <- nrow(df)
rw <- RWgenerators(10000, length(TKs))
ESWeights <- c()
retsweights <- c()
Sharpe <- c()
for(i in c(1:nrow(rw))){
ES <- Final_AdjCVaR_Function(rets, sigmas, cdcorr, s0, alfa, rw[i,], nsim_CVaR, nperiods)
ESWeights <- c(ESWeights, ES)
rs <- (sum(rets * rw[i,]))*100
retsweights <- c(retsweights, rs)
sh <- rs-ES
Sharpe <- c(Sharpe, sh)
print(length(ESWeights))
}
m <- min(ESWeights)
pos_min <- which(ESWeights == m)
MIN_CVaR_Portfolio <- rw[pos_min, ]
ma <- max(Sharpe)
pos_max <- which(Sharpe == ma)
MAX_SH_Portfolio <- rw[pos_max, ]
plot(ESWeights, retsweights)
print(MIN_CVaR_Portfolio)
print(MAX_SH_Portfolio)
source("gbm.r")
source("impstocks.r")
TKs <- c("^GSPC", "EEM", "VGK", "SPMO", "IJR", "AIA")
start <- "2016-05-03"
df <- GetStocks(TKs, start)
source("stock.r")
source("AdjustedCVaRProcedure.r")
source("AdjCVaRF.r")
source("randomPortfolios.r")
library(ggplot2)
source("gbm.r")
source("impstocks.r")
TKs <- c("^GSPC", "EEM", "VGK", "SPMO", "IJR", "AIA")
start <- "2016-05-03"
df <- GetStocks(TKs, start)
source("stock.r")
source("AdjustedCVaRProcedure.r")
source("AdjCVaRF.r")
source("randomPortfolios.r")
library(ggplot2)
alfa <- 0.05
nsim_CVaR <- 100
nperiods <- nrow(df)
rw <- RWgenerators(10000, length(TKs))
ESWeights <- c()
retsweights <- c()
Sharpe <- c()
for(i in c(1:nrow(rw))){
ES <- Final_AdjCVaR_Function(rets, sigmas, cdcorr, s0, alfa, rw[i,], nsim_CVaR, nperiods)
ESWeights <- c(ESWeights, ES)
rs <- (sum(rets * rw[i,]))*100
retsweights <- c(retsweights, rs)
sh <- rs-ES
Sharpe <- c(Sharpe, sh)
print(length(ESWeights))
}
m <- min(ESWeights)
pos_min <- which(ESWeights == m)
MIN_CVaR_Portfolio <- rw[pos_min, ]
ma <- max(Sharpe)
pos_max <- which(Sharpe == ma)
MAX_SH_Portfolio <- rw[pos_max, ]
plot(ESWeights, retsweights)
print(MIN_CVaR_Portfolio)
print(MAX_SH_Portfolio)
TKs
View(rw)
library(quantmod)
GetTS <- function(TKS, start){
FirstS <-as.data.frame(lapply(TKs[1], function(x) {getSymbols(x,
from = start,
periodicity = "monthly",
auto.assign=FALSE)} ))
df <- data.frame(FirstS[4])
for(i in TKs[2:length(TKs)]){
myStocks2 <-as.data.frame(lapply(i, function(x) {getSymbols(x,
from = start,
periodicity = "monthly",
auto.assign=FALSE)} ))
df <- cbind(df, myStocks2[4])
}
df
}
source("GetTicker.r")
setwd("C:/Users/LorenzoFancelli/Desktop/ExchangeRates Classifier")
source("GetTicker.r")
source("GetTickers.r")
library(dplyr)
TKs <- c("EURUSD=x")
TKs <- c("EURUSD=x", "2020-01-01")
start <- c("2020-01-01")
getTS(TKs)
source("GetTickers.r")
library(dplyr)
TKs <- c("EURUSD=x")
start <- c("2020-01-01")
getTS(, start)
setwd("C:/Users/LorenzoFancelli/Desktop/ExchangeRates Classifier")
getTS(, start)
GetTS(TKs, start)
TKs <- c("MSFT")
start <- c("2020-01-01")
GetTS(TKs, start)
source("gbm.r")
setwd("C:/Users/LorenzoFancelli/Desktop/My APP")
source("gbm.r")
source("impstocks.r")
TKs <- c("^GSPC", "EEM", "VGK", "SPMO", "IJR", "AIA")
start <- "2016-05-03"
df <- GetStocks(TKs, start)
df
TKs <- c("MSFT", "^GSPC")
start <- c("2020-01-01")
GetTS(TKs, start)
TKs <- c("MSFT")
start <- c("2020-01-01")
GetTS(TKs, start)
TKs <- c("MSFT", "AAPL")
start <- c("2020-01-01")
GetTS(TKs, start)
TKs <- c("AAPL")
start <- c("2020-01-01")
GetTS(TKs, start)
FirstS <-as.data.frame(lapply(TKs[1], function(x) {getSymbols("MSFT",
from = start,
periodicity = "daily",
auto.assign=FALSE)} ))
FirstS
FirstS <-as.data.frame(lapply("AAPL", function(x) {getSymbols(x,
from = start,
periodicity = "daily",
auto.assign=FALSE)} ))
FirstS
df <- data.frame()
df <- cbind(df, FirstS)
source("GetTickers.r")
library(dplyr)
setwd("C:/Users/LorenzoFancelli/Desktop/My APP")
source("GetTickers.r")
library(dplyr)
setwd("C:/Users/LorenzoFancelli/Desktop/ExchangeRates Classifier")
source("GetTickers.r")
library(dplyr)
TKs <- c("AAPL")
start <- c("2020-01-01")
GetTS(TKs, start)
source("GetTickers.r")
library(dplyr)
TKs <- c("AAPL")
start <- c("2020-01-01")
GetTS(TKs, start)
source("GetTickers.r")
library(dplyr)
TKs <- c("AAPL", "MSFT")
start <- c("2020-01-01")
GetTS(TKs, start)
FirstS <-as.data.frame(lapply("AAPL", function(x) {getSymbols(x,
from = start,
periodicity = "daily",
auto.assign=FALSE)} ))
TKs <- c("EURUSD=x")
start <- c("2020-01-01")
GetTS(TKs, start)
FirstS <-as.data.frame(lapply("AAPL", function(x) {getSymbols(x,
from = start,
periodicity = "daily",
auto.assign=FALSE)} ))
source("GetTickers.r")
library(dplyr)
TKs <- c("EURUSD=x")
start <- c("2020-01-01")
GetTS(TKs, start)
source("GetTickers.r")
library(dplyr)
TKs <- c("EURUSD=x")
start <- c("2018-01-01")
df <- GetTS(TKs, start)
source("GetTickers.r")
library(dplyr)
TKs <- c("EURUSD=x")
start <- c("2018-01-01")
df <- GetTS(TKs, start)
df
start <- c("2019-01-01")
df <- GetTS(TKs, start)
data <- data.frame(c(2:nrow(df)-1))
is.na(df)
source("GetTickers.r")
library(dplyr)
TKs <- c("EURUSD=x")
start <- c("2020-01-01")
df <- GetTS(TKs, start)
data <- data.frame(c(2:nrow(df)-1))
data
colnames(data) <- "To_remove"
for(i in colnames(df)[1:length(colnames(df))]){
v = as.vector(unlist(df[i]))
vr = diff(v)/(v[-length(v)])
data[i] <- vr
}
data
nrow(df)
nrow(data)
tail(df)
(1.073422 -1.073295)/1.073295
(1.073295-1.068661)/1.068661
tail(data)
data <- slice(data, 1:(n() - 1))
tail(data)
data[1]
source("GetTickers.r")
library(dplyr)
TKs <- c("EURUSD=x")
start <- c("2020-01-01")
df <- GetTS(TKs, start)
data <- data.frame(c(2:nrow(df)-1))
colnames(data) <- "To_remove"
for(i in colnames(df)[1:length(colnames(df))]){
v = as.vector(unlist(df[i]))
vr = diff(v)/(v[-length(v)])
data[i] <- vr
}
data[1]
source("GetTickers.r")
library(dplyr)
TKs <- c("EURUSD=x")
start <- c("2020-01-01")
df <- GetTS(TKs, start)
data <- data.frame(c(2:nrow(df)-1))
colnames(data) <- "To_remove"
for(i in colnames(df)[1:length(colnames(df))]){
v = as.vector(unlist(df[i]))
vr = diff(v)/(v[-length(v)])
data[i] <- vr
}
data$To_remove <- NULL
df <- df[-1, ]
df$Return <- data[1]
df
head(df)
source("GetTickers.r")
library(dplyr)
TKs <- c("EURUSD=x")
start <- c("2020-01-01")
df <- GetTS(TKs, start)
data <- data.frame(c(2:nrow(df)-1))
colnames(data) <- "To_remove"
for(i in colnames(df)[1:length(colnames(df))]){
v = as.vector(unlist(df[i]))
vr = diff(v)/(v[-length(v)])
data[i] <- vr
}
head(data)
head(df)
data$To_remove <- NULL
head(data)
head(data)
head(df)
data$To_remove <- NULL
df <- df[-1, ]
df$Return <- data$EURUSD.X.Close
index(df)
df
df
source("GetTickers.r")
library(dplyr)
TKs <- c("EURUSD=x")
start <- c("2020-01-01")
df <- GetTS(TKs, start)
data <- data.frame(c(2:nrow(df)-1))
index(df)
source("GetTickers.r")
library(dplyr)
TKs <- c("EURUSD=x")
start <- c("2020-01-01")
df <- GetTS(TKs, start)
head(df)
index(df)
df.index
df$Return <- as.vector(data$EURUSD.X.Close)
source("GetTickers.4r")
library(dplyr)
TKs <- c("EURUSD=x")
start <- c("2020-01-01")
df <- GetTS(TKs, start)
data <- data.frame(c(2:nrow(df)-1))
colnames(data) <- "To_remove"
source("GetTickers.r")
library(dplyr)
TKs <- c("EURUSD=x")
start <- c("2020-01-01")
df <- GetTS(TKs, start)
data <- data.frame(c(2:nrow(df)-1))
colnames(data) <- "To_remove"
for(i in colnames(df)[1:length(colnames(df))]){
v = as.vector(unlist(df[i]))
vr = diff(v)/(v[-length(v)])
data[i] <- vr
}
data$To_remove <- NULL
df <- df[-1, ]
df <- data.frame(data)
df$Return <- as.vector(data$EURUSD.X.Close)
df
source("GetTickers.r")
library(dplyr)
TKs <- c("EURUSD=x")
start <- c("2020-01-01")
df <- GetTS(TKs, start)
data <- data.frame(c(2:nrow(df)-1))
colnames(data) <- "To_remove"
for(i in colnames(df)[1:length(colnames(df))]){
v = as.vector(unlist(df[i]))
vr = diff(v)/(v[-length(v)])
data[i] <- vr
}
data$To_remove <- NULL
df <- df[-1, ]
df$Return <- as.vector(data[1])
dff <- cbind(df, data)
df
source("GetTickers.r")
library(dplyr)
TKs <- c("EURUSD=x")
start <- c("2020-01-01")
df <- GetTS(TKs, start)
data <- data.frame(c(2:nrow(df)-1))
colnames(data) <- "To_remove"
for(i in colnames(df)[1:length(colnames(df))]){
v = as.vector(unlist(df[i]))
vr = diff(v)/(v[-length(v)])
data[i] <- vr
}
data$To_remove <- NULL
df <- df[-1, ]
dff <- cbind(df, data)
dff
head(data)
head(df)
source("GetTickers.r")
library(dplyr)
TKs <- c("EURUSD=x")
start <- c("2020-01-01")
df <- GetTS(TKs, start)
data <- data.frame(c(2:nrow(df)-1))
colnames(data) <- "To_remove"
for(i in colnames(df)[1:length(colnames(df))]){
v = as.vector(unlist(df[i]))
vr = diff(v)/(v[-length(v)])
data[i] <- vr
}
head(df)
head(dataÃ¹)
head(df)
head(data)
source("GetTickers.r")
library(dplyr)
TKs <- c("GBPUSD=x")
start <- c("2020-01-01")
df <- GetTS(TKs, start)
data <- data.frame(c(2:nrow(df)-1))
colnames(data) <- "To_remove"
for(i in colnames(df)[1:length(colnames(df))]){
v = as.vector(unlist(df[i]))
vr = diff(v)/(v[-length(v)])
data[i] <- vr
}
head(df)
head(data)
source("GetTickers.r")
library(dplyr)
TKs <- c("GBPUSD=x")
start <- c("2020-01-01")
df <- GetTS(TKs, start)
data <- data.frame(c(2:nrow(df)-1))
colnames(data) <- "To_remove"
for(i in colnames(df)[1:length(colnames(df))]){
v = as.vector(unlist(df[i]))
vr = diff(v)/(v[-length(v)])
data[i] <- vr
}
data$To_remove <- NULL
df <- df[-1, ]
dff <- cbind(df, data)
head(dff)
(1.315270-1.3250301)/1.325030
head(dff)
( 1.310513 - 1.311372)/1.311372
head(df)
source("GetTickers.r")
library(dplyr)
TKs <- c("GBPUSD=x")
start <- c("2020-01-01")
df <- GetTS(TKs, start)
data <- data.frame(c(2:nrow(df)-1))
colnames(data) <- "To_remove"
for(i in colnames(df)[1:length(colnames(df))]){
v = as.vector(unlist(df[i]))
vr = diff(v)/(v[-length(v)])
data[i] <- vr
}
data$To_remove <- NULL
df2 <- df[-1, ]
dataEX <- cbind(df2, data)
head(ddataEX)
head(dataEX)
head(df)
(1.325030-1.326260)/1.326260
tail(dff)
tail(df)
source("rets.r")
df <- Calc_rets(df)
df
head(df)
tail(df)
source("GetTickers.r")
source("rets.r")
library(dplyr)
TKs <- c("GBPUSD=x")
start <- c("2020-01-01")
df <- GetTS(TKs, start)
tail(df)
source("GetTickers.r")
source("rets.r")
library(dplyr)
TKs <- c("GBPUSD=x")
start <- c("2020-01-01")
df <- GetTS(TKs, start)
df <- Calc_rets(df)
df$EWM_4day <- movavg(df$GBPUSD.X.Close , n=4, type='e')
library(pracma)
install.packages(pracma)
install.packages("pracma")
library(pracma)
source("GetTickers.r")
source("rets.r")
library(dplyr)
library(pracma)
TKs <- c("GBPUSD=x")
start <- c("2020-01-01")
df <- GetTS(TKs, start)
df <- Calc_rets(df)
df$EWM_4day <- movavg(df$GBPUSD.X.Close , n=4, type='e')
df
source("GetTickers.r")
source("rets.r")
library(dplyr)
library(pracma)
TKs <- c("GBPUSD=x")
start <- c("2020-01-01")
df <- GetTS(TKs, start)
df <- Calc_rets(df)
df$EWM_4day <- movavg(df$GBPUSD.X.Close , n=12, type='e')
df
source("GetTickers.r")
source("rets.r")
library(dplyr)
library(pracma)
TKs <- c("GBPUSD=x")
start <- c("2020-01-01")
df <- GetTS(TKs, start)
df <- Calc_rets(df)
df
colnames(df) <- c("Close, Rets")
source("GetTickers.r")
source("rets.r")
library(dplyr)
library(pracma)
TKs <- c("GBPUSD=x")
start <- c("2020-01-01")
df <- GetTS(TKs, start)
df <- Calc_rets(df)
colnames(df) <- c("Close, Rets")
df$EWM_4day <- movavg(df$Close , n=12, type='e')
df
