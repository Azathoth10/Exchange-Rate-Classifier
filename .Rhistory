sum(is.na(df[1]))
df <- Calc_rets(df)
colnames(df) <- c("Close", "Rets")
df$EWM_FAST <- movavg(df$Close , n=12, type='e')
df$EWM_SLOW <- movavg(df$Close , n=26, type='e')
df$MACD <- df$EWM_FAST - df$EWM_SLOW
df$signal <- movavg(df$MACD , n=9, type='e')
df$diffMACD <- df$MACD - df$signal
dff <- Slopecalc(df$Close, 5)
source("GetTickers.r")
source("rets.r")
source('slope.r')
library(dplyr)
library(pracma)
TKs <- c("GBPUSD=x")
start <- c("2014-01-01")
df <- GetTS(TKs, start)
df <- na.omit(df)
sum(is.na(df))
nrow(df)
sum(is.na(df[1]))
df <- Calc_rets(df)
colnames(df) <- c("Close", "Rets")
df$EWM_FAST <- movavg(df$Close , n=12, type='e')
df$EWM_SLOW <- movavg(df$Close , n=26, type='e')
df$MACD <- df$EWM_FAST - df$EWM_SLOW
df$signal <- movavg(df$MACD , n=9, type='e')
df$diffMACD <- df$MACD - df$signal
dff <- Slopecalc(df$Close, 5)
dff
coeffic <- c()
Slopecalc <- function(tser, n){
coeffic <- c()
dff <- data.frame(tser)
x <- c(1:n)
for(i in c((n+1):(nrow(dff)+1))){
y <- as.numeric(dff[(i-n):(i-1),])
cff <- as.numeric(as.matrix(summary(lm(y~x))$coefficients)[1,1])
coeffic <- c(coeffic, cff)
df <- tail(df, -n)
angles <- atan(coefficients)
df["slope"] <- coeffic
return(df)
}
}
dff <- Slopecalc(df$Close, 5)
Slopecalc <- function(tser, n){
coeffic <- c()
dff <- data.frame(tser)
x <- c(1:n)
for(i in c((n+1):(nrow(dff)+1))){
y <- as.numeric(dff[(i-n):(i-1),])
cff <- as.numeric(as.matrix(summary(lm(y~x))$coefficients)[1,1])
coeffic <- c(coeffic, cff)
df <- tail(df, -n)
angles <- atan(coefficients)
df["slope"] <- coeffic
return(df)
}
}
source("GetTickers.r")
source("rets.r")
source('slope.r')
library(dplyr)
library(pracma)
TKs <- c("GBPUSD=x")
start <- c("2014-01-01")
df <- GetTS(TKs, start)
df <- na.omit(df)
sum(is.na(df))
nrow(df)
sum(is.na(df[1]))
df <- Calc_rets(df)
colnames(df) <- c("Close", "Rets")
df$EWM_FAST <- movavg(df$Close , n=12, type='e')
df$EWM_SLOW <- movavg(df$Close , n=26, type='e')
df$MACD <- df$EWM_FAST - df$EWM_SLOW
df$signal <- movavg(df$MACD , n=9, type='e')
df$diffMACD <- df$MACD - df$signal
dff <- Slopecalc(df$Close, 5)
Slopecalc <- function(tser, n){
coeffic <- c()
dff <- data.frame(tser)
x <- c(1:n)
for(i in c((n+1):(nrow(dff)+1))){
y <- as.numeric(dff[(i-n):(i-1),])
cff <- as.numeric(as.matrix(summary(lm(y~x))$coefficients)[1,1])
coeffic <- c(coeffic, cff)
df <- tail(df, -n)
angles <- atan(coeffic)
df["slope"] <- coeffic
return(df)
}
}
dff <- Slopecalc(df$Close, 5)
dff
Slopecalc <- function(tser, n){
coeffic <- c()
dff <- data.frame(tser)
x <- c(1:n)
for(i in c((n+1):(nrow(dff)+1))){
y <- as.numeric(dff[(i-n):(i-1),])
cff <- as.numeric(as.matrix(summary(lm(y~x))$coefficients)[1,1])
coeffic <- c(coeffic, cff)
coeffic
df <- tail(df, -n)
angles <- atan(coeffic)
df["slope"] <- coeffic
return(df)
}
}
dff <- Slopecalc(df$Close, 5)
dff
Slopecalc <- function(tser, n){
coeffic <- c()
dff <- data.frame(tser)
x <- c(1:n)
for(i in c((n+1):(nrow(dff)+1))){
y <- as.numeric(dff[(i-n):(i-1),])
cff <- as.numeric(as.matrix(summary(lm(y~x))$coefficients)[1,1])
coeffic <- c(coeffic, cff)
coeffic
#df <- tail(df, -n)
#angles <- atan(coeffic)
#df["slope"] <- coeffic
return(df)
}
}
dff <- Slopecalc(df$Close, 5)
dff
Slopecalc <- function(tser, n){
coeffic <- c()
dff <- data.frame(tser)
x <- c(1:n)
for(i in c((n+1):(nrow(dff)+1))){
y <- as.numeric(dff[(i-n):(i-1),])
cff <- as.numeric(as.matrix(summary(lm(y~x))$coefficients)[1,1])
coeffic <- c(coeffic, cff)
coeffic
#df <- tail(df, -n)
#angles <- atan(coeffic)
#df["slope"] <- coeffic
}
}
dff <- Slopecalc(df$Close, 5)
dff
Slopecalc <- function(tser, n){
coeffic <- c()
dff <- data.frame(tser)
x <- c(1:n)
for(i in c((n+1):(nrow(dff)+1))){
y <- as.numeric(dff[(i-n):(i-1),])
cff <- as.numeric(as.matrix(summary(lm(y~x))$coefficients)[1,1])
coeffic <- c(coeffic, cff)
print(coeffic)
#df <- tail(df, -n)
#angles <- atan(coeffic)
#df["slope"] <- coeffic
}
}
dff <- Slopecalc(df$Close, 5)
dff <- tail(dff, -5)
dff
dff
df
df <- tail(df, -5)
df
Slopecalc <- function(tser, n){
coeffic <- c()
dff <- data.frame(tser)
x <- c(1:n)
for(i in c((n+1):(nrow(dff)+1))){
y <- as.numeric(dff[(i-n):(i-1),])
cff <- as.numeric(as.matrix(summary(lm(y~x))$coefficients)[1,1])
coeffic <- c(coeffic, cff)
print(coeffic)
df <- tail(df, -n+1)
angles <- atan(coeffic)
df$slopes <- angles
}
}
dff <- Slopecalc(df$Close, 5)
Slopecalc <- function(tser, n){
coeffic <- c()
dff <- data.frame(tser)
x <- c(1:n)
for(i in c((n+1):(nrow(dff)+1))){
y <- as.numeric(dff[(i-n):(i-1),])
cff <- as.numeric(as.matrix(summary(lm(y~x))$coefficients)[1,1])
coeffic <- c(coeffic, cff)
df <- tail(df, -n+1)
angles <- atan(coeffic)
df$slopes <- angles
return(df)
}
}
dff <- Slopecalc(df$Close, 5)
dff
Slopecalc <- function(tser, n){
coeffic <- c()
dff <- data.frame(tser)
x <- c(1:n)
for(i in c((n+1):(nrow(dff)+1))){
y <- as.numeric(dff[(i-n):(i-1),])
cff <- as.numeric(as.matrix(summary(lm(y~x))$coefficients)[1,1])
coeffic <- c(coeffic, cff)
df <- tail(df, -n+1)
angles <- atan(coeffic)
df$slopes <- coeffic
return(coeffic)
}
}
dff <- Slopecalc(df$Close, 5)
dff
source("GetTickers.r")
source("rets.r")
source('slope.r')
library(dplyr)
library(pracma)
TKs <- c("GBPUSD=x")
start <- c("2014-01-01")
df <- GetTS(TKs, start)
df <- na.omit(df)
sum(is.na(df))
nrow(df)
sum(is.na(df[1]))
df <- Calc_rets(df)
colnames(df) <- c("Close", "Rets")
df$EWM_FAST <- movavg(df$Close , n=12, type='e')
df$EWM_SLOW <- movavg(df$Close , n=26, type='e')
df$MACD <- df$EWM_FAST - df$EWM_SLOW
df$signal <- movavg(df$MACD , n=9, type='e')
df$diffMACD <- df$MACD - df$signal
seqran <- c((n+1):(length(df$Close)+1))
n = 5
seqran <- c((n+1):(length(df$Close)+1))
seqran
dfr <- data.frame(df$Close)
head(dfr)
dfr[(6-5):(5),]
for(i in seqran){
y <- dfr[(i-n):(i-1),]
x <- c(1:n)
cff <- as.numeric(as.matrix(summary(lm(y~x))$coefficients)[1,1])
print(cff)
}
df
y <- dfr[(90-5):(89),]
y
y <- dfr[(150-5):(149),]
y
x <- c(1:5)
lm(y~x)
y <- c(100,98,97,96,95)
x <- c(1:5)
lm(y~x)
for(i in seqran){
y <- dfr[(i-n):(i-1),]
x <- c(1:n)
cff <- as.numeric(as.matrix(summary(lm(y~x))$coefficients)[1,2])
print(cff)
}
Slopecalc <- function(tser, n){
coeffic <- c()
dff <- data.frame(tser)
x <- c(1:n)
for(i in c((n+1):(nrow(dff)+1))){
y <- as.numeric(dff[(i-n):(i-1),])
cff <- as.numeric(as.matrix(summary(lm(y~x))$coefficients)[2,1])
coeffic <- c(coeffic, cff)
df <- tail(df, -(n-1))
angles <- atan(coeffic)
df$slopes <- coeffic
return(coeffic)
}
}
source("GetTickers.r")
source("rets.r")
source('slope.r')
library(dplyr)
library(pracma)
TKs <- c("GBPUSD=x")
start <- c("2014-01-01")
df <- GetTS(TKs, start)
df <- na.omit(df)
sum(is.na(df))
nrow(df)
sum(is.na(df[1]))
df <- Calc_rets(df)
colnames(df) <- c("Close", "Rets")
df$EWM_FAST <- movavg(df$Close , n=12, type='e')
df$EWM_SLOW <- movavg(df$Close , n=26, type='e')
df$MACD <- df$EWM_FAST - df$EWM_SLOW
df$signal <- movavg(df$MACD , n=9, type='e')
df$diffMACD <- df$MACD - df$signal
source("GetTickers.r")
source("rets.r")
source('slope.r')
library(dplyr)
library(pracma)
TKs <- c("GBPUSD=x")
start <- c("2014-01-01")
df <- GetTS(TKs, start)
df <- na.omit(df)
sum(is.na(df))
nrow(df)
sum(is.na(df[1]))
df <- Calc_rets(df)
colnames(df) <- c("Close", "Rets")
df$EWM_FAST <- movavg(df$Close , n=12, type='e')
df$EWM_SLOW <- movavg(df$Close , n=26, type='e')
df$MACD <- df$EWM_FAST - df$EWM_SLOW
df$signal <- movavg(df$MACD , n=9, type='e')
df$diffMACD <- df$MACD - df$signal
sSlopecalc(df, df$Close, 5)
Slopecalc(df, df$Close, 5)
source("GetTickers.r")
source("rets.r")
source('slope.r')
library(dplyr)
library(pracma)
TKs <- c("GBPUSD=x")
start <- c("2014-01-01")
df <- GetTS(TKs, start)
df <- na.omit(df)
sum(is.na(df))
nrow(df)
sum(is.na(df[1]))
df <- Calc_rets(df)
colnames(df) <- c("Close", "Rets")
df$EWM_FAST <- movavg(df$Close , n=12, type='e')
df$EWM_SLOW <- movavg(df$Close , n=26, type='e')
df$MACD <- df$EWM_FAST - df$EWM_SLOW
df$signal <- movavg(df$MACD , n=9, type='e')
df$diffMACD <- df$MACD - df$signal
Slopecalc(df, df$Close, 5)
df <- data.frame(df$Close)
source("GetTickers.r")
source("rets.r")
source('slope.r')
library(dplyr)
library(pracma)
TKs <- c("GBPUSD=x")
start <- c("2014-01-01")
df <- GetTS(TKs, start)
df <- na.omit(df)
sum(is.na(df))
nrow(df)
sum(is.na(df[1]))
df <- Calc_rets(df)
colnames(df) <- c("Close", "Rets")
df$EWM_FAST <- movavg(df$Close , n=12, type='e')
df$EWM_SLOW <- movavg(df$Close , n=26, type='e')
df$MACD <- df$EWM_FAST - df$EWM_SLOW
df$signal <- movavg(df$MACD , n=9, type='e')
df$diffMACD <- df$MACD - df$signal
n = 5
dfr <- data.frame(df$Close)
coeffic <- c()
x <- c(1:5)
for(i in c((n+1):(nrow(df)+1))){
y <- dfr[((i-n):(i-1)),]
summ <- summary(lm(y~x))
coeff <- summ$coefficients
m <- coeff[2,1]
coeffic <- c(coeffic, m)
}
coeffic
atan(coeffic)
atan(coeffic[1])
coeffic[1]
angles <- atan(coeffic)
df <- tail(df, -(n-1))
length(coeffic)
nrow(df)
source("GetTickers.r")
source("rets.r")
source('slope.r')
library(dplyr)
library(pracma)
TKs <- c("GBPUSD=x")
start <- c("2014-01-01")
df <- GetTS(TKs, start)
df <- na.omit(df)
sum(is.na(df))
nrow(df)
sum(is.na(df[1]))
df <- Calc_rets(df)
colnames(df) <- c("Close", "Rets")
df$EWM_FAST <- movavg(df$Close , n=12, type='e')
df$EWM_SLOW <- movavg(df$Close , n=26, type='e')
df$MACD <- df$EWM_FAST - df$EWM_SLOW
df$signal <- movavg(df$MACD , n=9, type='e')
df$diffMACD <- df$MACD - df$signal
n = 5
dfr <- data.frame(df$Close)
coeffic <- c()
x <- c(1:5)
for(i in c((n+1):(nrow(df)+1))){
y <- dfr[((i-n):(i-1)),]
summ <- summary(lm(y~x))
coeff <- summ$coefficients
m <- coeff[2,1]
coeffic <- c(coeffic, m)
}
angles <- atan(coeffic)
df <- tail(df, -(n-1))
df$slopes <- angles
df
Calc_rets(df$slopes)
Calc_rets(data.frame(df$slopes))
source("GetTickers.r")
source("rets.r")
source('slope.r')
library(dplyr)
library(pracma)
TKs <- c("GBPUSD=x")
start <- c("2014-01-01")
df <- GetTS(TKs, start)
df <- na.omit(df)
sum(is.na(df))
nrow(df)
sum(is.na(df[1]))
df <- Calc_rets(df)
colnames(df) <- c("Close", "Rets")
df$EWM_FAST <- movavg(df$Close , n=12, type='e')
df$EWM_SLOW <- movavg(df$Close , n=26, type='e')
df$MACD <- df$EWM_FAST - df$EWM_SLOW
df$signal <- movavg(df$MACD , n=9, type='e')
df$diffMACD <- df$MACD - df$signal
n = 5
dfr <- data.frame(df$Close)
coeffic <- c()
x <- c(1:5)
for(i in c((n+1):(nrow(df)+1))){
y <- dfr[((i-n):(i-1)),]
summ <- summary(lm(y~x))
coeff <- summ$coefficients
m <- coeff[2,1]
coeffic <- c(coeffic, m)
}
angles <- atan(coeffic)
df <- tail(df, -(n-1))
df$slopes <- angles
df
source("GetTickers.r")
source("rets.r")
source('slope.r')
library(dplyr)
library(pracma)
TKs <- c("GBPUSD=x")
start <- c("2014-01-01")
df <- GetTS(TKs, start)
df <- na.omit(df)
sum(is.na(df))
nrow(df)
sum(is.na(df[1]))
df <- Calc_rets(df)
colnames(df) <- c("Close", "Rets")
df$EWM_FAST <- movavg(df$Close , n=12, type='e')
df$EWM_SLOW <- movavg(df$Close , n=26, type='e')
df$MACD <- df$EWM_FAST - df$EWM_SLOW
df$signal <- movavg(df$MACD , n=9, type='e')
df$diffMACD <- df$MACD - df$signal
n = 10
dfr <- data.frame(df$Close)
coeffic <- c()
x <- c(1:5)
for(i in c((n+1):(nrow(df)+1))){
y <- dfr[((i-n):(i-1)),]
summ <- summary(lm(y~x))
coeff <- summ$coefficients
m <- coeff[2,1]
coeffic <- c(coeffic, m)
}
angles <- atan(coeffic)
df <- tail(df, -(n-1))
df$slopes <- angles
source("GetTickers.r")
source("rets.r")
source('slope.r')
library(dplyr)
library(pracma)
TKs <- c("GBPUSD=x")
start <- c("2014-01-01")
df <- GetTS(TKs, start)
df <- na.omit(df)
sum(is.na(df))
nrow(df)
sum(is.na(df[1]))
df <- Calc_rets(df)
colnames(df) <- c("Close", "Rets")
df$EWM_FAST <- movavg(df$Close , n=12, type='e')
df$EWM_SLOW <- movavg(df$Close , n=26, type='e')
df$MACD <- df$EWM_FAST - df$EWM_SLOW
df$signal <- movavg(df$MACD , n=9, type='e')
df$diffMACD <- df$MACD - df$signal
n = 10
dfr <- data.frame(df$Close)
coeffic <- c()
x <- c(1:n)
for(i in c((n+1):(nrow(df)+1))){
y <- dfr[((i-n):(i-1)),]
summ <- summary(lm(y~x))
coeff <- summ$coefficients
m <- coeff[2,1]
coeffic <- c(coeffic, m)
}
angles <- atan(coeffic)
df <- tail(df, -(n-1))
df$slopes <- angles
df
