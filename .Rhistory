Slopecalc <- function(tser, n){
coeffic <- c()
dff <- data.frame(tser)
x <- c(1:n)
for(i in c((n+1):(nrow(dff)+1))){
y <- dff[(i-n):(i-1),]
cff <- as.matrix(summary(lm(y~x))$coefficients)[1,1]
coeffic <- c(coeffic, cff)
return(coeffic)
#df <- tail(df, -n)
#angles <- atan(coefficients)
#df["slope"] <- coeffic
}
}
Slopecalc(df$Close, 5)
for(i in c((5+1):nrow(dff)+1)){return(i)}
for(i in c((5+1):nrow(dff)+1)){
i
}
c((5+1):nrow(dff)+1)
for(i in c((5+1):nrow(dff)+1)){
print(i)
}
for(i in c((1997+1):nrow(dff)+1)){
print(i)
}
for(i in c((5+1):nrow(dff)+1)){
print(i)
}
for(i in c((5+1):nrow(dff)+1)){
print(i)
}
coeffic <- c()
for(i in c((5+1):nrow(dff)+1)){
coeffic <- c(coeffic, i)
}
coeffic
coeffic <- c()
for(i in c((4+1):nrow(dff)+1)){
coeffic <- c(coeffic, i)
}
coeffic
c(1:5)
coeffic <- c()
for(i in c(5:(nrow(dff)+1))){
coeffic <- c(coeffic, i)
}
coeffic
Slopecalc <- function(tser, n){
coeffic <- c()
dff <- data.frame(tser)
x <- c(1:n)
for(i in c(n+1:(nrow(dff)+1))){
y <- dff[(i-n):(i-1),]
cff <- as.matrix(summary(lm(y~x))$coefficients)[1,1]
coeffic <- c(coeffic, cff)
return(coeffic)
#df <- tail(df, -n)
#angles <- atan(coefficients)
#df["slope"] <- coeffic
}
}
Slopecalc(df$Close, 5)
dff[(7-5):(7-1),]
dff[(8-5):(8-1),]
Slopecalc(dff, 5)
Slopecalc <- function(tser, n){
coeffic <- c()
dff <- data.frame(tser)
x <- c(1:n)
for(i in c(n+1:(nrow(dff)+1))){
y <- dff[(i-n):(i-1),]
cff <- as.matrix(summary(lm(y~x))$coefficients)[1,1]
coeffic <- c(coeffic, cff)
#df <- tail(df, -n)
#angles <- atan(coefficients)
#df["slope"] <- coeffic
}
}
Slopecalc(dff,6)
Slopecalc(dff,5)
y <- dff[(7-5):(7-1),]
b <- c(1:5)
print(i)
lm(y~)
lm(y~b)
y <- dff[(8-5):(8-1),]
lm(y~b)
dff <- data.frame(dff)
dff[(8-5):(8-1),]
c <- c(1:5)
c
Slopecalc <- function(tser, n){
coeffic <- c()
dff <- data.frame(tser)
x <- c(1:n)
for(i in c(n+1:(nrow(dff)+1))){
y <- dff[(i-n):(i-1),]
cff <- as.numeric(as.matrix(summary(lm(y~x))$coefficients)[1,1])
coeffic <- c(coeffic, cff)
#df <- tail(df, -n)
#angles <- atan(coefficients)
#df["slope"] <- coeffic
}
}
slope(dff, 5)
Slopecalc(dff, 5)
Slopecalc <- function(tser, n){
coeffic <- c()
dff <- data.frame(tser)
x <- c(1:n)
for(i in c((n+1):(nrow(dff)+1))){
y <- dff[(i-n):(i-1),]
cff <- as.numeric(as.matrix(summary(lm(y~x))$coefficients)[1,1])
coeffic <- c(coeffic, cff)
#df <- tail(df, -n)
#angles <- atan(coefficients)
#df["slope"] <- coeffic
}
}
Slopecalc(dff,5)
Slopecalc <- function(tser, n){
coeffic <- c()
dff <- data.frame(tser)
x <- c(1:n)
for(i in c((n+1):(nrow(dff)+1))){
y <- dff[(i-n):(i-1),]
cff <- as.numeric(as.matrix(summary(lm(y~x))$coefficients)[1,1])
coeffic <- c(coeffic, cff)
return(coeffic)
#df <- tail(df, -n)
#angles <- atan(coefficients)
#df["slope"] <- coeffic
}
}
Slopecalc(dff,5)
n<- as.numeric(as.matrix(summary(lm(y~b))$coefficients)[1,1])
n
n2<- as.numeric(as.matrix(summary(lm(y~b))$coefficients)[1,1])
coeffic <- c(n, n2)
coeffic
Slopecalc <- function(tser, n){
coeffic <- c()
dff <- data.frame(tser)
x <- c(1:n)
for(i in c((n+1):(nrow(dff)+1))){
y <- dff[(i-n):(i-1),]
cff <- as.numeric(as.matrix(summary(lm(y~x))$coefficients)[1,1])
print(cff)
#df <- tail(df, -n)
#angles <- atan(coefficients)
#df["slope"] <- coeffic
}
}
Slopecalc(dff,5)
Slopecalc(dff,10)
dff[dff,20]
Slopecalc(dff,40)
Slopecalc <- function(tser, n){
coeffic <- c()
dff <- data.frame(tser)
x <- c(1:n)
for(i in c((n+1):(nrow(dff)+1))){
y <- dff[(i-n):(i-1),]
cff <- as.numeric(as.matrix(summary(lm(y~x))$coefficients)[1,1])
print(cff)
coeffic <- c(coeffic, cff)
#df <- tail(df, -n)
#angles <- atan(coefficients)
#df["slope"] <- coeffic
}
}
Slopecalc(dff, 5)
df <- Slopecalc(dff, 5)
dff
dff
Slopecalc <- function(tser, n){
coeffic <- c()
dff <- data.frame(tser)
x <- c(1:n)
for(i in c((n+1):(nrow(dff)+1))){
y <- dff[(i-n):(i-1),]
cff <- as.numeric(as.matrix(summary(lm(y~x))$coefficients)[1,1])
coeffic <- c(coeffic, cff)
df <- tail(df, -n)
angles <- atan(coefficients)
df["slope"] <- coeffic
}
}
Slopecalc(df$Close, 5)
Slopecalc <- function(tser, n){
coeffic <- c()
dff <- data.frame(tser)
x <- c(1:n)
for(i in c((n+1):(nrow(dff)+1))){
y <- as.numeric(dff[(i-n):(i-1),])
cff <- as.numeric(as.matrix(summary(lm(y~x))$coefficients)[1,1])
coeffic <- c(coeffic, cff)
df <- tail(df, -n)
angles <- atan(coefficients)
df["slope"] <- coeffic
}
}
Slopecalc(df$Close, 5)
Slopecalc <- function(tser, n){
coeffic <- c()
dff <- data.frame(tser)
x <- c(1:n)
for(i in c((n+1):(nrow(dff)+1))){
y <- as.numeric(dff[(i-n):(i-1),])
cff <- as.numeric(as.matrix(summary(lm(y~x))$coefficients)[1,1])
coeffic <- c(coeffic, cff)
coeffic
#df <- tail(df, -n)
#angles <- atan(coefficients)
#df["slope"] <- coeffic
}
}
Slopecalc(df$Close, 5)
source("GetTickers.r")
source("rets.r")
source('slope.r')
library(dplyr)
library(pracma)
TKs <- c("GBPUSD=x")
start <- c("2014-01-01")
df <- GetTS(TKs, start)
df <- na.omit(df)
sum(is.na(df))
nrow(df)
sum(is.na(df[1]))
df <- Calc_rets(df)
colnames(df) <- c("Close", "Rets")
df$EWM_FAST <- movavg(df$Close , n=12, type='e')
df$EWM_SLOW <- movavg(df$Close , n=26, type='e')
df$MACD <- df$EWM_FAST - df$EWM_SLOW
df$signal <- movavg(df$MACD , n=9, type='e')
df$diffMACD <- df$MACD - df$signal
Slopecalc(df$Close, 5)
source("GetTickers.r")
source("rets.r")
source('slope.r')
library(dplyr)
library(pracma)
TKs <- c("GBPUSD=x")
start <- c("2014-01-01")
df <- GetTS(TKs, start)
df <- na.omit(df)
sum(is.na(df))
nrow(df)
sum(is.na(df[1]))
df <- Calc_rets(df)
colnames(df) <- c("Close", "Rets")
df$EWM_FAST <- movavg(df$Close , n=12, type='e')
df$EWM_SLOW <- movavg(df$Close , n=26, type='e')
df$MACD <- df$EWM_FAST - df$EWM_SLOW
df$signal <- movavg(df$MACD , n=9, type='e')
df$diffMACD <- df$MACD - df$signal
dff <- Slopecalc(df$Close, 5)
source("GetTickers.r")
source("rets.r")
source('slope.r')
library(dplyr)
library(pracma)
TKs <- c("GBPUSD=x")
start <- c("2014-01-01")
df <- GetTS(TKs, start)
df <- na.omit(df)
sum(is.na(df))
nrow(df)
sum(is.na(df[1]))
df <- Calc_rets(df)
colnames(df) <- c("Close", "Rets")
df$EWM_FAST <- movavg(df$Close , n=12, type='e')
df$EWM_SLOW <- movavg(df$Close , n=26, type='e')
df$MACD <- df$EWM_FAST - df$EWM_SLOW
df$signal <- movavg(df$MACD , n=9, type='e')
df$diffMACD <- df$MACD - df$signal
dff <- Slopecalc(df$Close, 5)
dff
coeffic <- c()
Slopecalc <- function(tser, n){
coeffic <- c()
dff <- data.frame(tser)
x <- c(1:n)
for(i in c((n+1):(nrow(dff)+1))){
y <- as.numeric(dff[(i-n):(i-1),])
cff <- as.numeric(as.matrix(summary(lm(y~x))$coefficients)[1,1])
coeffic <- c(coeffic, cff)
df <- tail(df, -n)
angles <- atan(coefficients)
df["slope"] <- coeffic
return(df)
}
}
dff <- Slopecalc(df$Close, 5)
Slopecalc <- function(tser, n){
coeffic <- c()
dff <- data.frame(tser)
x <- c(1:n)
for(i in c((n+1):(nrow(dff)+1))){
y <- as.numeric(dff[(i-n):(i-1),])
cff <- as.numeric(as.matrix(summary(lm(y~x))$coefficients)[1,1])
coeffic <- c(coeffic, cff)
df <- tail(df, -n)
angles <- atan(coefficients)
df["slope"] <- coeffic
return(df)
}
}
source("GetTickers.r")
source("rets.r")
source('slope.r')
library(dplyr)
library(pracma)
TKs <- c("GBPUSD=x")
start <- c("2014-01-01")
df <- GetTS(TKs, start)
df <- na.omit(df)
sum(is.na(df))
nrow(df)
sum(is.na(df[1]))
df <- Calc_rets(df)
colnames(df) <- c("Close", "Rets")
df$EWM_FAST <- movavg(df$Close , n=12, type='e')
df$EWM_SLOW <- movavg(df$Close , n=26, type='e')
df$MACD <- df$EWM_FAST - df$EWM_SLOW
df$signal <- movavg(df$MACD , n=9, type='e')
df$diffMACD <- df$MACD - df$signal
dff <- Slopecalc(df$Close, 5)
Slopecalc <- function(tser, n){
coeffic <- c()
dff <- data.frame(tser)
x <- c(1:n)
for(i in c((n+1):(nrow(dff)+1))){
y <- as.numeric(dff[(i-n):(i-1),])
cff <- as.numeric(as.matrix(summary(lm(y~x))$coefficients)[1,1])
coeffic <- c(coeffic, cff)
df <- tail(df, -n)
angles <- atan(coeffic)
df["slope"] <- coeffic
return(df)
}
}
dff <- Slopecalc(df$Close, 5)
dff
Slopecalc <- function(tser, n){
coeffic <- c()
dff <- data.frame(tser)
x <- c(1:n)
for(i in c((n+1):(nrow(dff)+1))){
y <- as.numeric(dff[(i-n):(i-1),])
cff <- as.numeric(as.matrix(summary(lm(y~x))$coefficients)[1,1])
coeffic <- c(coeffic, cff)
coeffic
df <- tail(df, -n)
angles <- atan(coeffic)
df["slope"] <- coeffic
return(df)
}
}
dff <- Slopecalc(df$Close, 5)
dff
Slopecalc <- function(tser, n){
coeffic <- c()
dff <- data.frame(tser)
x <- c(1:n)
for(i in c((n+1):(nrow(dff)+1))){
y <- as.numeric(dff[(i-n):(i-1),])
cff <- as.numeric(as.matrix(summary(lm(y~x))$coefficients)[1,1])
coeffic <- c(coeffic, cff)
coeffic
#df <- tail(df, -n)
#angles <- atan(coeffic)
#df["slope"] <- coeffic
return(df)
}
}
dff <- Slopecalc(df$Close, 5)
dff
Slopecalc <- function(tser, n){
coeffic <- c()
dff <- data.frame(tser)
x <- c(1:n)
for(i in c((n+1):(nrow(dff)+1))){
y <- as.numeric(dff[(i-n):(i-1),])
cff <- as.numeric(as.matrix(summary(lm(y~x))$coefficients)[1,1])
coeffic <- c(coeffic, cff)
coeffic
#df <- tail(df, -n)
#angles <- atan(coeffic)
#df["slope"] <- coeffic
}
}
dff <- Slopecalc(df$Close, 5)
dff
Slopecalc <- function(tser, n){
coeffic <- c()
dff <- data.frame(tser)
x <- c(1:n)
for(i in c((n+1):(nrow(dff)+1))){
y <- as.numeric(dff[(i-n):(i-1),])
cff <- as.numeric(as.matrix(summary(lm(y~x))$coefficients)[1,1])
coeffic <- c(coeffic, cff)
print(coeffic)
#df <- tail(df, -n)
#angles <- atan(coeffic)
#df["slope"] <- coeffic
}
}
dff <- Slopecalc(df$Close, 5)
dff <- tail(dff, -5)
dff
dff
df
df <- tail(df, -5)
df
Slopecalc <- function(tser, n){
coeffic <- c()
dff <- data.frame(tser)
x <- c(1:n)
for(i in c((n+1):(nrow(dff)+1))){
y <- as.numeric(dff[(i-n):(i-1),])
cff <- as.numeric(as.matrix(summary(lm(y~x))$coefficients)[1,1])
coeffic <- c(coeffic, cff)
print(coeffic)
df <- tail(df, -n+1)
angles <- atan(coeffic)
df$slopes <- angles
}
}
dff <- Slopecalc(df$Close, 5)
Slopecalc <- function(tser, n){
coeffic <- c()
dff <- data.frame(tser)
x <- c(1:n)
for(i in c((n+1):(nrow(dff)+1))){
y <- as.numeric(dff[(i-n):(i-1),])
cff <- as.numeric(as.matrix(summary(lm(y~x))$coefficients)[1,1])
coeffic <- c(coeffic, cff)
df <- tail(df, -n+1)
angles <- atan(coeffic)
df$slopes <- angles
return(df)
}
}
dff <- Slopecalc(df$Close, 5)
dff
Slopecalc <- function(tser, n){
coeffic <- c()
dff <- data.frame(tser)
x <- c(1:n)
for(i in c((n+1):(nrow(dff)+1))){
y <- as.numeric(dff[(i-n):(i-1),])
cff <- as.numeric(as.matrix(summary(lm(y~x))$coefficients)[1,1])
coeffic <- c(coeffic, cff)
df <- tail(df, -n+1)
angles <- atan(coeffic)
df$slopes <- coeffic
return(coeffic)
}
}
dff <- Slopecalc(df$Close, 5)
dff
source("GetTickers.r")
source("rets.r")
source('slope.r')
library(dplyr)
library(pracma)
TKs <- c("GBPUSD=x")
start <- c("2014-01-01")
df <- GetTS(TKs, start)
df <- na.omit(df)
sum(is.na(df))
nrow(df)
sum(is.na(df[1]))
df <- Calc_rets(df)
colnames(df) <- c("Close", "Rets")
df$EWM_FAST <- movavg(df$Close , n=12, type='e')
df$EWM_SLOW <- movavg(df$Close , n=26, type='e')
df$MACD <- df$EWM_FAST - df$EWM_SLOW
df$signal <- movavg(df$MACD , n=9, type='e')
df$diffMACD <- df$MACD - df$signal
seqran <- c((n+1):(length(df$Close)+1))
n = 5
seqran <- c((n+1):(length(df$Close)+1))
seqran
dfr <- data.frame(df$Close)
head(dfr)
dfr[(6-5):(5),]
for(i in seqran){
y <- dfr[(i-n):(i-1),]
x <- c(1:n)
cff <- as.numeric(as.matrix(summary(lm(y~x))$coefficients)[1,1])
print(cff)
}
df
y <- dfr[(90-5):(89),]
y
y <- dfr[(150-5):(149),]
y
x <- c(1:5)
lm(y~x)
y <- c(100,98,97,96,95)
x <- c(1:5)
lm(y~x)
for(i in seqran){
y <- dfr[(i-n):(i-1),]
x <- c(1:n)
cff <- as.numeric(as.matrix(summary(lm(y~x))$coefficients)[1,2])
print(cff)
}
